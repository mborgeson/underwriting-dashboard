# Underwriting Dashboard

A data processing and visualization system for real estate underwriting models at B&R Capital.

## Project Overview

This application monitors real estate deal folders for underwriting models, extracts key data points from these models, stores them in a database, and presents them in an interactive dashboard.

### Features

- Automatic identification of relevant underwriting models based on file criteria
- Data extraction from specific cells in Excel models based on reference mapping
- Real-time monitoring of file changes and updates
- Interactive dashboard with filtering, search, and download capabilities
- Mapping visualization of properties and comparables
- Mobile-responsive design

## Installation and Setup

1. Clone this repository
2. Create a conda environment: `conda create -n underwriting_dashboard python=3.11`
3. Activate the environment: `conda activate underwriting_dashboard`
4. Install dependencies: `conda install -r requirements.txt`
5. Configure paths in the `config/config.py` file if needed
6. Run the application: `python main.py`

## Project Structure

Underwriting Dashboard/
│
├── database/ # SQLite database storage
│ └── underwriting_models.db # Main SQLite database file
│
├── logs/ # Application logs
│ ├── app.log # Main application logs
│ ├── monitoring.log # File monitoring logs
│ └── dashboard.log # Dashboard operation logs
│
├── prompt/ # Project specification documents
│ └── Underwriting Dashboard Project - Cell Value References.xlsx
│
├── src/ # Source code
│ ├── data_processing/ # Data extraction and processing modules
│ │ ├── **init** .py
│ │ ├── file_finder.py # Logic for identifying relevant Excel files
│ │ ├── excel_reader.py # Logic for reading data from Excel files
│ │ └── reference_parser.py # Parses reference file for cell mappings
│ │
│ ├── database/ # Database interaction modules
│ │ ├── **init** .py
│ │ ├── db_manager.py # Core database operations (create, read, update)
│ │ ├── schema.py # Database schema definition
│ │ └── models.py # ORM models (if applicable)
│ │
│ ├── file_monitoring/ # File monitoring and change detection
│ │ ├── **init** .py
│ │ ├── monitor.py # File system monitoring and change detection
│ │ └── handlers.py # Event handlers for file changes
│ │
│ └── dashboard/ # Dashboard application
│ ├── **init** .py
│ ├── app.py # Main dashboard application
│ ├── components/ # Reusable dashboard components
│ │ ├── **init** .py
│ │ ├── filters.py # Filter components
│ │ ├── tables.py # Table display components
│ │ └── maps.py # Map visualization components
│ │
│ ├── pages/ # Dashboard pages
│ │ ├── **init** .py
│ │ ├── home.py # Home/overview page
│ │ ├── details.py # Detailed property view
│ │ └── analysis.py # Analysis and comparison tools
│ │
│ └── assets/ # Static assets for dashboard
│ ├── css/ # Custom CSS styles
│ ├── js/ # Custom JavaScript
│ └── images/ # Images and icons
│
├── tests/ # Test cases
│ ├── **init** .py
│ ├── test_data/ # Test data files
│ ├── test_data_processing/ # Tests for data processing
│ ├── test_database/ # Tests for database functionality
│ └── test_file_monitoring/ # Tests for file monitoring
│
├── config/ # Configuration files
│ ├── **init** .py
│ ├── config.py # Main configuration settings
│ └── logging_config.py # Logging configuration
│
├── main.py # Application entry point
├── requirements.txt # Project dependencies
└── README.md # Project documentation

## Usage

### Running the Application

1. **Start the application**:
   1. python main.py

This will initiate the file scanning, database setup, and launch the dashboard.

2. **Access the dashboard**:

- Open your web browser and navigate to: `http://localhost:8501`
- For remote access: `http://[your-ip-address]:8501`

### Dashboard Navigation

1. **Main Dashboard View**:

- Overview of all properties in the database
- Key metrics and stats at the top
- Interactive map of properties
- Filterable data table

2. **Filtering Data**:

- Use the sidebar filters to narrow down properties by:
  - Deal stage (Dead, Initial UW, Active UW, Under Contract, Closed, Realized)
  - Property characteristics (name, city, submarket)
  - Date ranges (last modified date)
  - Performance metrics (cap rate, IRR, etc.)

3. **Property Details**:

- Click on any property in the table or map to view detailed information
- All extracted data points from the underwriting model are displayed
- Compare against benchmarks or other properties

4. **Data Export**:

- Use the "Download" button to export filtered data as Excel (.xlsx)
- Choose specific columns or export all data

5. **Refreshing Data**:

- Click the "Refresh" button to manually trigger a scan for updated files
- The system automatically checks for updates every minute

### Mobile Access

1. Access the same URL from a mobile device
2. The interface will automatically adapt to the smaller screen
3. Use the hamburger menu to access filters and options
4. Swipe gestures are enabled for table navigation

## Development

### Getting Started

1. **Set up the development environment**:

   1. conda create -n underwriting_dashboard_dev python=3.11
   2. conda activate underwriting_dashboard_dev
   3. pip install -r requirements.txt
   4. pip install -r requirements-dev.txt # Additional dev dependencies
2. **Run tests**:

   1. pytest
3. **Run with debug logging**:

   1. python main.py --debug

   ### Coding Standards


   1. **Code Style**:

   - Follow PEP 8 conventions
   - Use Black for code formatting: `black src/`
   - Use descriptive variable names and comprehensive docstrings
   - Run linting before commits: `flake8 src/`

   2. **Documentation**:

   - All functions and classes must have docstrings
   - Complex logic should include explanatory comments
   - Update the README when adding new features

   3. **Testing**:

   - Write unit tests for all new functionality
   - Integration tests for component interactions
   - Target 80%+ code coverage

   ### Development Workflow

   1. **Feature Development**:

   - Create a new branch for each feature: `feature/feature-name`
   - Implement functionality with accompanying tests
   - Update documentation as needed
   - Create a PR for review

   2. **Bug Fixes**:

   - Create a branch: `fix/bug-description`
   - Add a test that reproduces the bug
   - Fix the bug
   - Verify the test passes

   3. **Dashboard Components**:

   - Create reusable components in `src/dashboard/components/`
   - Follow Streamlit best practices for performance
   - Test UI elements for various screen sizes

   ### Extending the Project

   1. **Adding New Data Points**:

   - Update the reference Excel file with new cell mappings
   - The application will automatically detect and use the new mappings
   - No code changes required for standard data point additions

   2. **Adding Dashboard Features**:

   - Add new components to the appropriate modules
   - Register new pages in the dashboard app.py
   - Follow existing patterns for consistency

   3. **Performance Optimization**:

   - Profile slow operations with cProfile
   - Consider caching for frequently accessed data
   - Use async operations for file monitoring where appropriate
